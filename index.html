<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Classificador Gato ou Cachorro ğŸ±ğŸ¶</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }

        #preview {
            max-width: 300px;
            margin: 20px auto;
            border-radius: 10px;
        }

        #result {
            font-size: 24px;
            margin-top: 20px;
        }

        input {
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <h1>Classificador Gato ou Cachorro ğŸ±ğŸ¶</h1>
    <input type="file" accept="image/*" onchange="loadImage(event)">
    <img id="preview" />
    <div id="result">Envie uma imagem!</div>

    <script>
        const MODEL_URL = "https://teachablemachine.withgoogle.com/models/i7vPHJXFP/";
        let model, isModelReady = false;

        async function init() {
            try {
                document.getElementById('result').innerText = "Carregando modelo...";
                const modelURL = MODEL_URL + "model.json";
                const metadataURL = MODEL_URL + "metadata.json";
                model = await tmImage.load(modelURL, metadataURL);
                isModelReady = true;
                document.getElementById('result').innerText = "Modelo pronto! Envie uma imagem.";
            } catch (error) {
                console.error("Erro ao carregar modelo:", error);
                document.getElementById('result').innerText = "Erro ao carregar modelo. Verifique a URL!";
            }
        }
        init();

        async function loadImage(event) {
            const file = event.target.files[0];
            if (!file) return;

            const image = document.getElementById('preview');
            image.src = window.URL.createObjectURL(file);
            
            image.onload = async () => {
                if (!isModelReady) {
                    document.getElementById('result').innerText = "Modelo ainda carregando...";
                    return;
                }
                
                try {
                    document.getElementById('result').innerText = "Analisando...";
                    const prediction = await model.predict(image);
                    const best = prediction.reduce((a, b) => a.probability > b.probability ? a : b);
                    const emoji = best.className.toLowerCase().includes("gato") ? "ğŸ±" : "ğŸ¶";
                    const confidence = (best.probability * 100).toFixed(1);
                    document.getElementById('result').innerText = `Ã‰ um ${best.className}! ${emoji} (${confidence}% de certeza)`;
                } catch (error) {
                    console.error("Erro ao classificar:", error);
                    document.getElementById('result').innerText = "Erro ao analisar a imagem.";
                }
            };
        }
    </script>
</body>

</html>

